"use strict";!function e(t,n,o){function r(a,l){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!l&&c)return c(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=n[a]={exports:{}};t[a][0].call(s.exports,function(e){var n=t[a][1][e];return r(n?n:e)},s,s.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){!function(){function t(){var e=new XMLHttpRequest,t=void 0;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){try{t=JSON.parse(e.response)}catch(e){alert("Invalid Server response. Sorry!")}l=new a(t)}},e.open("GET","data/image_posts.json"),e.send()}function n(e,t){var n=1e3*parseFloat(window.getComputedStyle(t).transitionDuration);"in"==e?(t.style.display="block",t.style.opacity=0,setTimeout(function(){t.style.opacity=1},4)):(t.style.opacity=0,setTimeout(function(){t.style.display="none"},n))}function o(e,t){var n=e.className.split(" ");return n.indexOf(t)>-1}function r(e,t){var n=e.className.split(" "),o=n.indexOf(t);o>-1&&n.splice(o,1),e.className=n.join(" ")}function i(e,t){o(e,t)||(e.className+=" "+t)}var a=(e("./modules/scrollbar.es6.js"),e("./modules/image-collection.es6.js")),l={};t(),document.addEventListener("DOMContentLoaded",function(){function e(e){var t=a.nicknameNode,n=a.commentNode,o=e.target,r=a.button;o.value&&(o.style.borderColor=""),o.value||(r.style.cursor=""),t.value&&n.value&&(r.style.cursor="pointer")}var t=function(){var e=document.querySelector(".popup.orientation-chose");return function(t){var o=t.target.files[0],r=/^image\//,i=void 0;if(o){if(!r.test(o.type))return void alert("You must upload an image!");i=new FileReader,i.onload=function(t){var o=e.querySelectorAll("img");[].forEach.call(o,function(e){e.src=t.target.result}),n("in",e)},i.readAsDataURL(o)}}}();document.querySelector('input[type="file"]').addEventListener("change",t);var a=document.querySelector(".popup-comments");a.nicknameNode=document.getElementById("nickname"),a.commentNode=document.getElementById("comment"),a.nicknameLabel=document.querySelector('[for="nickname"]'),a.commentLabel=document.querySelector('[for="comment"]'),a.placeholders={nickname:a.nicknameLabel.getAttribute("data-placeholder"),comment:a.commentLabel.getAttribute("data-placeholder")},a.button=document.querySelector(".send-button");var c=function(){var e=a.placeholders;return function(t){var n=t.target;if("INPUT"===n.tagName){var o=n.nextElementSibling;n.value?(n.style.borderColor="",o.setAttribute("data-placeholder","")):(n.style.borderColor="red",o.style.color="red",o.setAttribute("data-placeholder",e[n.id]))}}}();a.addEventListener("blur",c,!0),a.addEventListener("input",e);var s=function(){function e(e){var t=+e.getAttribute("data-id"),o=l.getImagePost(t);m.style.backgroundImage="url("+o.imgBig+")",p.setAttribute("data-count",o.likes),v.setAttribute("data-count",o.dislikes),"like"==o.myEvaluation?i(p.parentNode,"clicked"):"dislike"==o.myEvaluation&&i(v.parentNode,"clicked"),o.showComments(t),n("in",u),u.currentId=t}function t(e,t){l.addImagePost({imgBig:e,orientation:t}),n("out",f)}function c(e){if("I"===e.tagName&&(e=e.parentNode),!o(e,"clicked")){var t=u.querySelector(".image-button.clicked"),n=o(e,"like");t&&(r(t,"clicked"),l.evaluate(u.currentId,!n,!1,t)),i(e,"clicked"),l.evaluate(u.currentId,n,!0,e)}}function s(){var e=a.nicknameNode.value,t=a.commentNode.value;if(e&&comment){a.nicknameNode.value=a.commentNode.value="";var n=new Date;l.addComment(u.currentId,{text:t,nickname:e,date:n})}}function d(){var e=u.querySelector(".clicked");e&&r(e,"clicked");var t=a.nicknameNode,n=a.commentNode,o=a.placeholders.nickname,i=a.placeholders.comment,l=a.nicknameLabel,c=a.commentLabel;t.value=n.value="",t.style.borderColor=n.style.borderColor="",l.style.color=c.style.color="",a.button.style.cursor="",l.setAttribute("data-placeholder",o),c.setAttribute("data-placeholder",i)}var u=document.querySelector(".popup.big-img"),m=u.querySelector(".image-big"),p=u.querySelector(".sprite-like"),v=u.querySelector(".sprite-dislike"),f=(u.querySelector("h2 span"),document.querySelector(".popup.orientation-chose")),g=void 0;return function(r){var i=r.target;"IMG"===i.tagName?e(i):(g=i.getAttribute("data-orientation"))?t(i.firstElementChild.src,g):o(i,"image-button")||o(i.parentNode,"image-button")?c(i):o(i,"sprite-close")?(d(),n("out",u)):(o(i,"send-button")||o(i.parentNode,"send-button"))&&(s(),r.preventDefault())}}();document.body.addEventListener("click",s)})}()},{"./modules/image-collection.es6.js":2,"./modules/scrollbar.es6.js":3}],2:[function(e,t,n){!function(){function n(e){function t(e){for(var t=0,n=0,o=e.length;n<o;n++)t=e[n].id>t?e[n].id:t;return t}for(var n=[],r=t(e),i=0,a=e.length;i<a;i++)n.push(new o(e[i]));this.getImagePost=function(e){for(var t=0,o=n.length;t<o;t++)if(n[t].id===e)return n[t];console.log("No image post with id:",e)},this.addImagePost=function(e){e.id||(e.id=++r);var t=new o(e);n.push(t)}}function o(e){var t=this;this.id=e.id||null,this.imgSmall=e.imgSmall||e.imgBig,this.imgBig=e.imgBig,this.orientation=e.orientation||"normal",this.likes=e.likes||0,this.dislikes=e.dislikes||0,this.comments=[],this.myEvaluation=null,e.comments&&e.comments.sort(function(e,t){return t.date-e.date}),e.comments&&e.comments.forEach(function(e){t.comments.push(new i(e.text,e.nickname,e.date))}),this.node=r(this)}function r(e){function t(e,t){var n=document.createElement("I");return n.className="sprite "+e,n.setAttribute("data-count",t),n}var n=void 0,o=void 0,r=void 0;switch(n=document.createElement("DIV"),e.orientation){case"landscape":n.className="grid-item grid-item--width";break;case"portrait":n.className="grid-item grid-item--height";break;default:n.className="grid-item"}return o=document.createElement("IMG"),o.src=e.imgSmall,o.alt="Image "+e.id,o.setAttribute("data-id",e.id),n.appendChild(o),r=document.createElement("DIV"),r.className="hover-box",r.appendChild(t("sprite-comment",e.comments.length)),r.appendChild(t("sprite-like",e.likes)),r.appendChild(t("sprite-dislike",e.dislikes)),n.appendChild(r),c.insertBefore(n,c.lastElementChild),s.reloadItems(),s.layout(),d.adjustSize(),n}function i(e,t,n){this.text=e,this.nickname=t,this.date=a(new Date(n))}function a(e){var t=e.getMinutes();t=t<10?"0"+t:t;var n=e.getHours(),o=n>12?"PM":"AM";n=n>12?n-12:n;var r=864e5,i=void 0,a=void 0,l=void 0,c=void 0,s=new Date;if(a=Math.round((s-e)/r),c=s.getFullYear()-e.getFullYear(),a>365){var d=1==c?" year":" years";i=c+d+" ago"}else if(a>31){l=s.getMonth()-e.getMonth(),c&&(l+=12);var u=1==l?" month":" months";i=l+u+" ago"}else i=a>1?a+" days ago":1==a?"Yesterday":"Today";return i+" "+n+":"+t+" "+o}var l=e("./scrollbar.es6.js"),c=document.querySelector(".grid"),s=new Packery(c,{itemSelector:".grid-item",gutter:10,horizontal:!0}),d=new l(document.querySelector(".scroll-bar"),"h");d.adjustSize(),n.prototype.evaluate=function(e,t,n,o){var r=this.getImagePost(e),i=document.querySelector('[data-id="'+e+'"]'),a=t?"like":"dislike",l=i.nextElementSibling.querySelector(".sprite-"+a),c=void 0;r.myEvaluation=a,c=n?++r[a+"s"]:--r[a+"s"],l.setAttribute("data-count",c),o.firstElementChild.setAttribute("data-count",c)},n.prototype.addComment=function(e,t){var n=this.getImagePost(e);n.comments.unshift(new i(t.text,t.nickname,t.date)),n.showComments(e)},o.prototype.showComments=function(){var e=document.querySelector(".comments");return function(t){e.innerHTML="",this.comments.forEach(function(t){t.putOnPage(e)}),document.querySelector(".popup-comments h2 span").textContent=this.comments.length,t&&this.node.querySelector(".sprite-comment").setAttribute("data-count",this.comments.length)}}(),i.prototype.putOnPage=function(e){function t(e,t){var n=document.createElement("SPAN");return n.className=e,n.textContent=t,n}var n=document.createElement("DIV");n.className="comment",n.appendChild(t("nickname",this.nickname)),n.appendChild(t("date",this.date));var o=document.createElement("DIV");o.className="comment-text",o.appendChild(t("",this.text)),n.appendChild(o),e.appendChild(n)},t.exports=n}()},{"./scrollbar.es6.js":3}],3:[function(e,t,n){!function(){t.exports=function(e,t){var n=e.parentNode,o=document.querySelector(n.getAttribute("data-scrolled-area")),r=o.parentNode,i=function(){var e=o.clientWidth,t=r.clientWidth;return e>t?t/e*100+"%":"100%"};this.adjustSize=function(){var t=i();"100%"==t?n.style.opacity=0:(n.style.opacity=1,e.style.width=t)};var a=function(){var t=null,n=parseFloat(window.getComputedStyle(e).marginLeft),o=e.parentNode.clientWidth,i=function e(i){var a=void 0,l=e.currentTarget,c=e.scrollBarSize,s=e.scrollAreaSize;return null===t?void(t=i.clientX):(a=i.clientX-t,t=i.clientX,n+=a,n<=0?(l.style.marginLeft=n=0,void(r.scrollLeft=0)):(c+n>=o&&(n=o-c),l.style.marginLeft=n+"px",void(r.scrollLeft=n/o*s)))},a=function(){window.removeEventListener("mousemove",i),t=null};return window.addEventListener("mouseup",a),window.addEventListener("blur",a),i}();e.addEventListener("mousedown",function(e){a.currentTarget=e.target,"h"==t?(a.scrollBarSize=e.target.clientWidth,a.scrollAreaSize=o.clientWidth):"v"==t&&(a.scrollBarSize=e.target.clientHeight,a.scrollAreaSize=o.clientHeight),window.addEventListener("mousemove",a)})}}()},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uZXM2LmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJFcnJvciIsImYiLCJleHBvcnRzIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJtb2R1bGUiLCJnZXREYXRhIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJkYXRhIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlIiwiYWxlcnQiLCJpbWFnZUNvbGxlY3Rpb24iLCJJbWFnZUNvbGxlY3Rpb24iLCJvcGVuIiwic2VuZCIsImZhZGVQb3B1cCIsImRpcmVjdGlvbiIsIm5vZGUiLCJ0cmFuc2l0aW9uRHVyYXRpb24iLCJwYXJzZUZsb2F0Iiwid2luZG93IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInN0eWxlIiwiZGlzcGxheSIsIm9wYWNpdHkiLCJzZXRUaW1lb3V0IiwiaGFzQ2xhc3MiLCJlbGVtIiwiY2xhc3NOYW1lIiwiY2xhc3NlcyIsInNwbGl0IiwiaW5kZXhPZiIsInJlbW92ZUNsYXNzIiwiaW5kZXgiLCJzcGxpY2UiLCJqb2luIiwiYWRkQ2xhc3MiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbnB1dEhhbmRsZXIiLCJuaWNrbmFtZSIsImlucHV0cyIsIm5pY2tuYW1lTm9kZSIsImNvbW1lbnQiLCJjb21tZW50Tm9kZSIsInRndCIsInRhcmdldCIsImJ1dHRvbiIsInZhbHVlIiwiYm9yZGVyQ29sb3IiLCJjdXJzb3IiLCJmaWxlSGFuZGxlciIsIm9yaWVudGF0aW9uUG9wdXAiLCJxdWVyeVNlbGVjdG9yIiwiZmlsZSIsImZpbGVzIiwiaW1nVHlwZVBhdHRlcm4iLCJyZWFkZXIiLCJ0ZXN0IiwidHlwZSIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJpbWdzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbWciLCJzcmMiLCJyZXN1bHQiLCJyZWFkQXNEYXRhVVJMIiwiZ2V0RWxlbWVudEJ5SWQiLCJuaWNrbmFtZUxhYmVsIiwiY29tbWVudExhYmVsIiwicGxhY2Vob2xkZXJzIiwiZ2V0QXR0cmlidXRlIiwiYmx1ckhhbmRsZXIiLCJ0YWdOYW1lIiwibGFiZWwiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJzZXRBdHRyaWJ1dGUiLCJjb2xvciIsImlkIiwiY2xpY2tMaXN0ZW5lciIsInNob3dCaWdJbWdQb3B1cCIsImltZ1Bvc3QiLCJnZXRJbWFnZVBvc3QiLCJpbWdCaWciLCJiYWNrZ3JvdW5kSW1hZ2UiLCJsaWtlSWNvbiIsImxpa2VzIiwiZGlzbGlrZUljb24iLCJkaXNsaWtlcyIsIm15RXZhbHVhdGlvbiIsInBhcmVudE5vZGUiLCJzaG93Q29tbWVudHMiLCJiaWdJbWdQb3B1cCIsImN1cnJlbnRJZCIsImNyZWF0ZU5ld0ltZ1Bvc3QiLCJvcmllbnRhdGlvbiIsImFkZEltYWdlUG9zdCIsImhhbmRsZUJpZ0ltZ0J1dHRvbnMiLCJvdGhlckNsaWNrZWRCdXR0b24iLCJpc0xpa2UiLCJldmFsdWF0ZSIsImFkZENvbW1lbnQiLCJ0ZXh0IiwiZGF0ZSIsIkRhdGUiLCJjbGVhclBvcHVwIiwiY2xpY2tlZEJ1dHRvbiIsIm5pY2tuYW1lUGxhY2Vob2xkZXIiLCJjb21tZW50UGxhY2Vob2xkZXIiLCJmaXJzdEVsZW1lbnRDaGlsZCIsInByZXZlbnREZWZhdWx0IiwiYm9keSIsIi4vbW9kdWxlcy9pbWFnZS1jb2xsZWN0aW9uLmVzNi5qcyIsIi4vbW9kdWxlcy9zY3JvbGxiYXIuZXM2LmpzIiwiMiIsImdldExhc3RJZCIsImNvbGxlY3Rpb24iLCJsYXN0SWQiLCJwdXNoIiwiSW1hZ2VQb3N0IiwidGhpcyIsImNvbnNvbGUiLCJsb2ciLCJpbWdJbmZvT2JqIiwiaW1hZ2VQb3N0IiwiX3RoaXMiLCJpbWdTbWFsbCIsImNvbW1lbnRzIiwic29ydCIsImIiLCJDb21tZW50IiwicHV0SW5HcmlkIiwic2VsZiIsImFkZEljb24iLCJkYXRhQ291bnQiLCJpY29uIiwiY3JlYXRlRWxlbWVudCIsImdyaWRJdGVtIiwiaG92ZXJCb3giLCJhbHQiLCJhcHBlbmRDaGlsZCIsImdyaWQiLCJpbnNlcnRCZWZvcmUiLCJsYXN0RWxlbWVudENoaWxkIiwicGNrcnkiLCJyZWxvYWRJdGVtcyIsImxheW91dCIsInNjcm9sbFgiLCJhZGp1c3RTaXplIiwicGFyc2VEYXRlIiwibWludXRlcyIsImdldE1pbnV0ZXMiLCJob3VycyIsImdldEhvdXJzIiwiZGF5UGFydCIsIm9uZURheSIsImRpZmYiLCJkaWZmRGF5cyIsImRpZmZNb250aCIsImRpZmZZZWFyIiwibm93IiwiTWF0aCIsInJvdW5kIiwiZ2V0RnVsbFllYXIiLCJ5ZWFyIiwiZ2V0TW9udGgiLCJtb250aCIsIlNjcm9sbGJhciIsIlBhY2tlcnkiLCJpdGVtU2VsZWN0b3IiLCJndXR0ZXIiLCJob3Jpem9udGFsIiwicHJvdG90eXBlIiwiaXNQbHVzIiwiZXZhbHVhdGlvbiIsImljb25TbWFsbCIsImN1cnJlbnRWYWx1ZSIsInBvc3QiLCJ1bnNoaWZ0IiwiY29tbWVudHNEaXYiLCJpbm5lckhUTUwiLCJwdXRPblBhZ2UiLCJ0ZXh0Q29udGVudCIsImNyZWF0ZVNwYW4iLCJzcGFuIiwiLi9zY3JvbGxiYXIuZXM2LmpzIiwiMyIsInNjcm9sbEJhciIsInNjcm9sbEJveCIsInNjcm9sbGVkQXJlYSIsInNjcm9sbGVkQm94IiwiZ2V0QXJlYVRvQm94UmF0aW8iLCJhcmVhV2lkdGgiLCJjbGllbnRXaWR0aCIsImJveFdpZHRoIiwicmF0aW8iLCJ3aWR0aCIsIm9uTW92ZSIsImxhc3RNb3VzZVgiLCJtYXJnaW4iLCJtYXJnaW5MZWZ0Iiwic2Nyb2xsQm94V2lkdGgiLCJjdXJyZW50VGFyZ2V0Iiwic2Nyb2xsQmFyU2l6ZSIsInNjcm9sbEFyZWFTaXplIiwiY2xpZW50WCIsInNjcm9sbExlZnQiLCJyZW1vdmVTY3JvbGxMaXN0ZW5lcnMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY2xpZW50SGVpZ2h0Il0sIm1hcHBpbmdzIjoiY0FBQSxR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bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbi8vIFRPRE86IGFkZCBwb3B1cCBcIm9uYmx1clwiXHJcbi8vIFRPRE86IGlucHV0cy5hZGRQbGFjZWhvbGRlcnMoKSAtID4gYm90aCwgKCduaWNrbmFtZScpIC0+IG5pY2tuYW1lXHJcbigoKSA9PiB7XHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IFNjcm9sbGJhciA9IHJlcXVpcmUoJy4vbW9kdWxlcy9zY3JvbGxiYXIuZXM2LmpzJyk7XHJcbmNvbnN0IEltYWdlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJy4vbW9kdWxlcy9pbWFnZS1jb2xsZWN0aW9uLmVzNi5qcycpO1xyXG5cclxuLy8gQUxMIFRIRSBJTkZPUk1BVElPTiBBQk9VVCBJTUFHRVMsIElOQ0xVRElORyBDT01NRU5UU1xyXG5sZXQgaW1hZ2VDb2xsZWN0aW9uID0ge307XHJcbmdldERhdGEoKTtcclxuXHJcbmZ1bmN0aW9uIGdldERhdGEoKSB7XHJcbiAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLCBkYXRhO1xyXG4gIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XHJcblxyXG4gICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQgJiYgeGhyLnN0YXR1cyA9PSAyMDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2UpO1xyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgYWxlcnQoJ0ludmFsaWQgU2VydmVyIHJlc3BvbnNlLiBTb3JyeSEnKTtcclxuICAgICAgfVxyXG4gICAgICBpbWFnZUNvbGxlY3Rpb24gPSBuZXcgSW1hZ2VDb2xsZWN0aW9uKGRhdGEpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHhoci5vcGVuKCdHRVQnLCAnZGF0YS9pbWFnZV9wb3N0cy5qc29uJyk7XHJcbiAgeGhyLnNlbmQoKTtcclxufVxyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcclxuICAvL1RPRE86IGFkZCBsb2FkZXIgaW50byBncmlkIGNvcyBpbWFnZXMgbG9hZGluZyBjYW4gdGFrZSBhIHdoaWxlXHJcblxyXG4gIC8vIEFERElORyBORVcgSU1BR0VcclxuICBsZXQgZmlsZUhhbmRsZXIgPSAoKCkgPT4ge1xyXG4gICAgbGV0IG9yaWVudGF0aW9uUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAub3JpZW50YXRpb24tY2hvc2UnKTtcclxuXHJcbiAgICByZXR1cm4gKGUpID0+IHtcclxuICAgICAgbGV0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXSxcclxuICAgICAgICAgIGltZ1R5cGVQYXR0ZXJuID0gL15pbWFnZVxcLy8sXHJcbiAgICAgICAgICByZWFkZXI7XHJcblxyXG4gICAgICAvLyB1c3IgZGlkbid0IHVwbG9hZCBhbnl0aGluZ1xyXG4gICAgICBpZiAoIWZpbGUpIHJldHVybjtcclxuXHJcbiAgICAgIC8vIGlmIG5vdCBvZiB0eXBlIGltYWdlXHJcbiAgICAgIGlmICghaW1nVHlwZVBhdHRlcm4udGVzdChmaWxlLnR5cGUpKSB7XHJcbiAgICAgICAgYWxlcnQoJ1lvdSBtdXN0IHVwbG9hZCBhbiBpbWFnZSEnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgICByZWFkZXIub25sb2FkID0gKGUpID0+IHtcclxuICAgICAgICBsZXQgaW1ncyA9IG9yaWVudGF0aW9uUG9wdXAucXVlcnlTZWxlY3RvckFsbCgnaW1nJyk7XHJcbiAgICAgICAgW10uZm9yRWFjaC5jYWxsKGltZ3MsIChpbWcpID0+IHtcclxuICAgICAgICAgIGltZy5zcmMgPSBlLnRhcmdldC5yZXN1bHQ7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBmYWRlUG9wdXAoJ2luJywgb3JpZW50YXRpb25Qb3B1cCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcclxuICAgIH07XHJcbiAgfSkoKTtcclxuXHJcblxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJylcclxuICAuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsZUhhbmRsZXIpO1xyXG5cclxuICAvLyBGT1JNIFZBTElEQVRJT04uXHJcbiAgLy8gSXQncyBjdXN0b20gdmFsaWRhdGlvbiB0byBnZXQgd2lkZXIgc3VwcG9ydCBpbiBzdHlsaW5nIHBsYWNlaG9sZGVyc1xyXG4gIGxldCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtY29tbWVudHMnKTtcclxuICBpbnB1dHMubmlja25hbWVOb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25pY2tuYW1lJyk7XHJcbiAgaW5wdXRzLmNvbW1lbnROb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnQnKTtcclxuICBpbnB1dHMubmlja25hbWVMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tmb3I9XCJuaWNrbmFtZVwiXScpO1xyXG4gIGlucHV0cy5jb21tZW50TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZm9yPVwiY29tbWVudFwiXScpO1xyXG4gIGlucHV0cy5wbGFjZWhvbGRlcnMgPSB7XHJcbiAgICBuaWNrbmFtZTogaW5wdXRzLm5pY2tuYW1lTGFiZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXBsYWNlaG9sZGVyJyksXHJcbiAgICBjb21tZW50OiBpbnB1dHMuY29tbWVudExhYmVsLmdldEF0dHJpYnV0ZSgnZGF0YS1wbGFjZWhvbGRlcicpXHJcbiAgfTtcclxuICBpbnB1dHMuYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbmQtYnV0dG9uJyk7XHJcblxyXG4gIGxldCBibHVySGFuZGxlciA9ICgoKSA9PiB7XHJcbiAgICBsZXQgcGxhY2Vob2xkZXJzID0gaW5wdXRzLnBsYWNlaG9sZGVycztcclxuXHJcbiAgICByZXR1cm4gKGUpID0+IHtcclxuICAgICAgbGV0IHRndCA9IGUudGFyZ2V0O1xyXG4gICAgICBpZiAodGd0LnRhZ05hbWUgIT09ICdJTlBVVCcpIHJldHVybjtcclxuICAgICAgbGV0IGxhYmVsID0gdGd0Lm5leHRFbGVtZW50U2libGluZztcclxuXHJcbiAgICAgIGlmICghdGd0LnZhbHVlKSB7XHJcbiAgICAgICAgdGd0LnN0eWxlLmJvcmRlckNvbG9yID0gJ3JlZCc7XHJcbiAgICAgICAgbGFiZWwuc3R5bGUuY29sb3IgPSAncmVkJztcclxuICAgICAgICAvLyBhZGQgcGxhY2Vob2xkZXJcclxuICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGxhY2Vob2xkZXInLCBwbGFjZWhvbGRlcnNbdGd0LmlkXSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGd0LnN0eWxlLmJvcmRlckNvbG9yID0gJyc7XHJcbiAgICAgICAgLy8gZGVsZXRlIHBsYWNlaG9sZGVyXHJcbiAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdkYXRhLXBsYWNlaG9sZGVyJywgJycpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH0pKCk7XHJcblxyXG4gIGlucHV0cy5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgYmx1ckhhbmRsZXIsIHRydWUpO1xyXG5cclxuICBmdW5jdGlvbiBpbnB1dEhhbmRsZXIoZSkge1xyXG4gICAgbGV0IG5pY2tuYW1lID0gaW5wdXRzLm5pY2tuYW1lTm9kZTtcclxuICAgIGxldCBjb21tZW50ID0gaW5wdXRzLmNvbW1lbnROb2RlO1xyXG4gICAgbGV0IHRndCA9IGUudGFyZ2V0O1xyXG4gICAgbGV0IGJ1dHRvbiA9IGlucHV0cy5idXR0b247XHJcblxyXG4gICAgaWYgKHRndC52YWx1ZSkge1xyXG4gICAgICB0Z3Quc3R5bGUuYm9yZGVyQ29sb3IgPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXRndC52YWx1ZSkge1xyXG4gICAgICBidXR0b24uc3R5bGUuY3Vyc29yID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG5pY2tuYW1lLnZhbHVlICYmIGNvbW1lbnQudmFsdWUpIHtcclxuICAgICAgYnV0dG9uLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlucHV0cy5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGlucHV0SGFuZGxlcik7XHJcblxyXG5cclxuICAvLyBHUklEIExJU1RFTkVSUyAtPiBQT1BVUCAmJiBBREQgTkVXIElNQUdFXHJcbiAgbGV0IGNsaWNrTGlzdGVuZXIgPSAoKCkgPT4ge1xyXG4gICAgLy9jbG9zdXJlXHJcbiAgICBsZXQgYmlnSW1nUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAuYmlnLWltZycpO1xyXG4gICAgbGV0IGltZ0JpZyA9IGJpZ0ltZ1BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS1iaWcnKTtcclxuICAgIGxldCBsaWtlSWNvbiA9IGJpZ0ltZ1BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5zcHJpdGUtbGlrZScpO1xyXG4gICAgbGV0IGRpc2xpa2VJY29uID0gYmlnSW1nUG9wdXAucXVlcnlTZWxlY3RvcignLnNwcml0ZS1kaXNsaWtlJyk7XHJcbiAgICBsZXQgY29tbWVudHNOdW1iZXIgPSBiaWdJbWdQb3B1cC5xdWVyeVNlbGVjdG9yKCdoMiBzcGFuJyk7XHJcbiAgICBsZXQgb3JpZW50YXRpb25Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC5vcmllbnRhdGlvbi1jaG9zZScpO1xyXG4gICAgbGV0IG9yaWVudGF0aW9uO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNob3dCaWdJbWdQb3B1cCh0YXJnZXQpIHtcclxuICAgICAgbGV0IGlkID0gK3RhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTtcclxuICAgICAgbGV0IGltZ1Bvc3QgPSBpbWFnZUNvbGxlY3Rpb24uZ2V0SW1hZ2VQb3N0KGlkKTtcclxuXHJcbiAgICAgIGltZ0JpZy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKCcgKyBpbWdQb3N0LmltZ0JpZyArICcpJztcclxuICAgICAgbGlrZUljb24uc2V0QXR0cmlidXRlKCdkYXRhLWNvdW50JywgaW1nUG9zdC5saWtlcyk7XHJcbiAgICAgIGRpc2xpa2VJY29uLnNldEF0dHJpYnV0ZSgnZGF0YS1jb3VudCcsIGltZ1Bvc3QuZGlzbGlrZXMpO1xyXG4gICAgICAvLyBpZiAxIG9mIGJ0dG9uIHdhcyBwcmVzc2VkIGJ5IHVzZXIgaXQgc2hvdWxkIHJlbWFpbiBwcmVzc2VkXHJcbiAgICAgIGlmIChpbWdQb3N0Lm15RXZhbHVhdGlvbiA9PSAnbGlrZScpIHtcclxuICAgICAgICBhZGRDbGFzcyhsaWtlSWNvbi5wYXJlbnROb2RlLCAnY2xpY2tlZCcpO1xyXG4gICAgICB9IGVsc2UgaWYgKGltZ1Bvc3QubXlFdmFsdWF0aW9uID09ICdkaXNsaWtlJykge1xyXG4gICAgICAgIGFkZENsYXNzKGRpc2xpa2VJY29uLnBhcmVudE5vZGUsICdjbGlja2VkJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGNvbW1lbnRzTnVtYmVyLnRleHRDb250ZW50ID0gaW1nUG9zdC5jb21tZW50cy5sZW5ndGg7XHJcbiAgICAgIGltZ1Bvc3Quc2hvd0NvbW1lbnRzKGlkKTtcclxuICAgICAgZmFkZVBvcHVwKCdpbicsIGJpZ0ltZ1BvcHVwKTtcclxuXHJcbiAgICAgIC8vIHJlbWVtYmVyIGlkIG9mIHRoZSBjdXJyZW50IGltYWdlXHJcbiAgICAgIGJpZ0ltZ1BvcHVwLmN1cnJlbnRJZCA9IGlkO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU5ld0ltZ1Bvc3QoaW1nQmlnLCBvcmllbnRhdGlvbikge1xyXG4gICAgICBpbWFnZUNvbGxlY3Rpb24uYWRkSW1hZ2VQb3N0KHtpbWdCaWcsIG9yaWVudGF0aW9ufSk7XHJcbiAgICAgIGZhZGVQb3B1cCgnb3V0Jywgb3JpZW50YXRpb25Qb3B1cCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdGd0IC0+IGNsaWNrIHRhcmdldFxyXG4gICAgZnVuY3Rpb24gaGFuZGxlQmlnSW1nQnV0dG9ucyh0Z3QpIHtcclxuICAgIC8vIGlmIGNsaWNrIG9uIGNoaWxkIG5vZGVcclxuICAgICAgaWYgKHRndC50YWdOYW1lID09PSAnSScpIHRndCA9IHRndC5wYXJlbnROb2RlO1xyXG5cclxuICAgICAgaWYgKGhhc0NsYXNzKHRndCwgJ2NsaWNrZWQnKSkgcmV0dXJuO1xyXG4gICAgLy8gaWYgdGhlcmUgaXMgYWxyZWFkeSBhIGNsaWNrZWQgYnV0dG9uIC0+IHVuY2xpY2sgaXRcclxuICAgICAgbGV0IG90aGVyQ2xpY2tlZEJ1dHRvbiA9IGJpZ0ltZ1BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS1idXR0b24uY2xpY2tlZCcpO1xyXG4gICAgICBsZXQgaXNMaWtlID0gaGFzQ2xhc3ModGd0LCAnbGlrZScpO1xyXG5cclxuICAgICAgaWYgKG90aGVyQ2xpY2tlZEJ1dHRvbikge1xyXG4gICAgICAgIC8vIC0xIGZvciBsaWtlcyBvciBkaXNsaWtlc1xyXG4gICAgICAgIHJlbW92ZUNsYXNzKG90aGVyQ2xpY2tlZEJ1dHRvbiwgJ2NsaWNrZWQnKTtcclxuICAgICAgICBpbWFnZUNvbGxlY3Rpb24uZXZhbHVhdGUoYmlnSW1nUG9wdXAuY3VycmVudElkLCAhaXNMaWtlLCBmYWxzZSwgb3RoZXJDbGlja2VkQnV0dG9uKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gXCJwcmVzc1wiIHRoZSBidXR0b25cclxuICAgICAgYWRkQ2xhc3ModGd0LCAnY2xpY2tlZCcpO1xyXG4gICAgICAvLyArMSBmb3IgbGlrZXMgb3IgZGlzbGlrZXNcclxuICAgICAgaW1hZ2VDb2xsZWN0aW9uLmV2YWx1YXRlKGJpZ0ltZ1BvcHVwLmN1cnJlbnRJZCwgaXNMaWtlLCB0cnVlLCB0Z3QpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkZENvbW1lbnQoKSB7XHJcbiAgICAgIGxldCBuaWNrbmFtZSA9IGlucHV0cy5uaWNrbmFtZU5vZGUudmFsdWU7XHJcbiAgICAgIGxldCB0ZXh0ID0gaW5wdXRzLmNvbW1lbnROb2RlLnZhbHVlO1xyXG4gICAgICBpZiAoIW5pY2tuYW1lIHx8ICFjb21tZW50KSByZXR1cm47XHJcblxyXG4gICAgICAvL2NsZWFyIGlucHV0c1xyXG4gICAgICBpbnB1dHMubmlja25hbWVOb2RlLnZhbHVlID0gaW5wdXRzLmNvbW1lbnROb2RlLnZhbHVlID0gJyc7XHJcbiAgICAgIGlucHV0c1xyXG5cclxuICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICBpbWFnZUNvbGxlY3Rpb24uYWRkQ29tbWVudChiaWdJbWdQb3B1cC5jdXJyZW50SWQsIHtcclxuICAgICAgICB0ZXh0LFxyXG4gICAgICAgIG5pY2tuYW1lLFxyXG4gICAgICAgIGRhdGVcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xlYXJQb3B1cCgpIHtcclxuICAgICAgLy8gdW5jbGljayBsaWtlIGJ1dHRvbnNcclxuICAgICAgbGV0IGNsaWNrZWRCdXR0b24gPSBiaWdJbWdQb3B1cC5xdWVyeVNlbGVjdG9yKCcuY2xpY2tlZCcpO1xyXG4gICAgICBpZiAoY2xpY2tlZEJ1dHRvbikgcmVtb3ZlQ2xhc3MoY2xpY2tlZEJ1dHRvbiwgJ2NsaWNrZWQnKTtcclxuXHJcbiAgICAgIC8vIHJlbW92ZSBjdXJyZW50IGlucHV0IHZhbHVlcyBhbmQgc3R5bGluZ1xyXG4gICAgICBsZXQgbmlja25hbWUgPSBpbnB1dHMubmlja25hbWVOb2RlO1xyXG4gICAgICBsZXQgY29tbWVudCA9IGlucHV0cy5jb21tZW50Tm9kZTtcclxuICAgICAgbGV0IG5pY2tuYW1lUGxhY2Vob2xkZXIgPSBpbnB1dHMucGxhY2Vob2xkZXJzLm5pY2tuYW1lO1xyXG4gICAgICBsZXQgY29tbWVudFBsYWNlaG9sZGVyID0gaW5wdXRzLnBsYWNlaG9sZGVycy5jb21tZW50O1xyXG4gICAgICBsZXQgbmlja25hbWVMYWJlbCA9IGlucHV0cy5uaWNrbmFtZUxhYmVsO1xyXG4gICAgICBsZXQgY29tbWVudExhYmVsID0gaW5wdXRzLmNvbW1lbnRMYWJlbDtcclxuXHJcbiAgICAgIG5pY2tuYW1lLnZhbHVlID0gY29tbWVudC52YWx1ZSA9ICcnO1xyXG4gICAgICBuaWNrbmFtZS5zdHlsZS5ib3JkZXJDb2xvciA9XHJcbiAgICAgIGNvbW1lbnQuc3R5bGUuYm9yZGVyQ29sb3IgPSAnJztcclxuICAgICAgbmlja25hbWVMYWJlbC5zdHlsZS5jb2xvciA9IGNvbW1lbnRMYWJlbC5zdHlsZS5jb2xvciA9ICcnO1xyXG4gICAgICBpbnB1dHMuYnV0dG9uLnN0eWxlLmN1cnNvciA9ICcnO1xyXG5cclxuICAgICAgLy8gYWRkIHBsYWNlaG9sZGVyc1xyXG4gICAgICBuaWNrbmFtZUxhYmVsLnNldEF0dHJpYnV0ZSgnZGF0YS1wbGFjZWhvbGRlcicsIG5pY2tuYW1lUGxhY2Vob2xkZXIpO1xyXG4gICAgICBjb21tZW50TGFiZWwuc2V0QXR0cmlidXRlKCdkYXRhLXBsYWNlaG9sZGVyJywgY29tbWVudFBsYWNlaG9sZGVyKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBhY3R1YWwgbGlzdGVuZXJcclxuICAgIHJldHVybiAoZSkgPT4ge1xyXG4gICAgICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQ7XHJcblxyXG4gICAgICAvLyBjbGljayBvbiBpbWFnZXMgb24gbWFpbiB3aW5kb3dcclxuICAgICAgaWYgKHRhcmdldC50YWdOYW1lID09PSAnSU1HJykge1xyXG4gICAgICAgIHNob3dCaWdJbWdQb3B1cCh0YXJnZXQpO1xyXG5cclxuICAgICAgLy8gY2xpY2sgb24gb3JpZW50YXRpb24gaW1hZ2VzIG9uIHBvcHVwXHJcbiAgICAgIH0gZWxzZSBpZiAob3JpZW50YXRpb24gPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWVudGF0aW9uJykpIHtcclxuXHJcbiAgICAgICAgY3JlYXRlTmV3SW1nUG9zdCh0YXJnZXQuZmlyc3RFbGVtZW50Q2hpbGQuc3JjLCBvcmllbnRhdGlvbik7XHJcblxyXG4gICAgICAvLyAqKioqKioqKioqKioqIFBPUFVQICoqKioqKioqKioqKioqKioqXHJcbiAgICAgIC8vIExpa2UgYW5kIERpc2xpa2UgYnV0dG9uc1xyXG4gICAgICB9IGVsc2UgaWYgKGhhc0NsYXNzKHRhcmdldCwgJ2ltYWdlLWJ1dHRvbicpIHx8XHJcbiAgICAgICAgICAgICAgIGhhc0NsYXNzKHRhcmdldC5wYXJlbnROb2RlLCAnaW1hZ2UtYnV0dG9uJykpIHtcclxuXHJcbiAgICAgICAgaGFuZGxlQmlnSW1nQnV0dG9ucyh0YXJnZXQpO1xyXG5cclxuICAgICAgfSBlbHNlIGlmIChoYXNDbGFzcyh0YXJnZXQsICdzcHJpdGUtY2xvc2UnKSkge1xyXG4gICAgICAgIGNsZWFyUG9wdXAoKTtcclxuICAgICAgICBmYWRlUG9wdXAoJ291dCcsIGJpZ0ltZ1BvcHVwKTtcclxuXHJcbiAgICAgIC8vdG8gcHJldmVudCBmb2N1c2luZyBpbnB1dFxyXG4gICAgfSBlbHNlIGlmIChoYXNDbGFzcyh0YXJnZXQsICdzZW5kLWJ1dHRvbicpIHx8XHJcbiAgICAgICAgICAgICAgIGhhc0NsYXNzKHRhcmdldC5wYXJlbnROb2RlLCAnc2VuZC1idXR0b24nKSkge1xyXG4gICAgICAgIGFkZENvbW1lbnQoKTtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSkoKTtcclxuXHJcbiAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrTGlzdGVuZXIpO1xyXG5cclxufSk7Ly9lbmQgRE9NQ29udGVudExvYWRlZFxyXG5cclxuXHJcbi8vIFVTRUZVTCBGVU5DVElPTlNcclxuZnVuY3Rpb24gZmFkZVBvcHVwKGRpcmVjdGlvbiwgbm9kZSkge1xyXG4gIGxldCB0cmFuc2l0aW9uRHVyYXRpb24gPSBwYXJzZUZsb2F0KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG5vZGUpLnRyYW5zaXRpb25EdXJhdGlvbikgKiAxMDAwO1xyXG5cclxuICBpZiAoZGlyZWN0aW9uID09ICdpbicpIHtcclxuICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICBub2RlLnN0eWxlLm9wYWNpdHkgPSAwO1xyXG5cclxuICAgIC8vIHRvIGVuYWJsZSBwcm9wZXIgdHJhbnNpdGlvbmluZyB3aXRoIG1pbmltYWwgZGVsYXlcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7IG5vZGUuc3R5bGUub3BhY2l0eSA9IDE7IH0sIDQpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBub2RlLnN0eWxlLm9wYWNpdHkgPSAwO1xyXG5cclxuICAgIC8vIHRyYW5zaXRpb25EdXJhdGlvblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7IG5vZGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgfSwgdHJhbnNpdGlvbkR1cmF0aW9uKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhc0NsYXNzKGVsZW0sIGNsYXNzTmFtZSkge1xyXG4gIGxldCBjbGFzc2VzID0gZWxlbS5jbGFzc05hbWUuc3BsaXQoJyAnKTtcclxuICByZXR1cm4gY2xhc3Nlcy5pbmRleE9mKGNsYXNzTmFtZSkgPiAtMTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWxlbSwgY2xhc3NOYW1lKSB7XHJcbiAgbGV0IGNsYXNzZXMgPSBlbGVtLmNsYXNzTmFtZS5zcGxpdCgnICcpO1xyXG4gIGxldCBpbmRleCA9IGNsYXNzZXMuaW5kZXhPZihjbGFzc05hbWUpO1xyXG4gIGlmIChpbmRleCA+IC0xKSBjbGFzc2VzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgZWxlbS5jbGFzc05hbWUgPSBjbGFzc2VzLmpvaW4oJyAnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbSwgY2xhc3NOYW1lKSB7XHJcbiAgaWYgKCFoYXNDbGFzcyhlbGVtLCBjbGFzc05hbWUpKVxyXG4gIGVsZW0uY2xhc3NOYW1lICs9ICcgJyArIGNsYXNzTmFtZTtcclxufVxyXG5cclxuXHJcbn0pKCk7XHJcblxyXG4vL1RPRE86IERPTSBlbGVtZW50cywgdGhhdCB1IG1hbmFnZSB0aHJvdWdoIEpTIG11c3QgaGF2ZSBkYXRhLVxyXG5cbn0se1wiLi9tb2R1bGVzL2ltYWdlLWNvbGxlY3Rpb24uZXM2LmpzXCI6MixcIi4vbW9kdWxlcy9zY3JvbGxiYXIuZXM2LmpzXCI6M31dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uKCkge1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5jb25zdCBTY3JvbGxiYXIgPSByZXF1aXJlKCcuL3Njcm9sbGJhci5lczYuanMnKTtcclxuXHJcbmxldCBncmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdyaWQnKTtcclxuLy8gc2V0IGxheW91dCBvZiBpbWFnZXNcclxubGV0IHBja3J5ID0gbmV3IFBhY2tlcnkoZ3JpZCwge1xyXG4gIGl0ZW1TZWxlY3RvcjogJy5ncmlkLWl0ZW0nLFxyXG4gIGd1dHRlcjogMTAsXHJcbiAgaG9yaXpvbnRhbDogdHJ1ZVxyXG59KTtcclxuXHJcbmxldCBzY3JvbGxYID0gbmV3IFNjcm9sbGJhcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsLWJhcicpLCAnaCcpO1xyXG5zY3JvbGxYLmFkanVzdFNpemUoKTtcclxuXHJcbmZ1bmN0aW9uIEltYWdlQ29sbGVjdGlvbihkYXRhKSB7XHJcbiAgbGV0IGNvbGxlY3Rpb24gPSBbXTtcclxuICBsZXQgbGFzdElkID0gZ2V0TGFzdElkKGRhdGEpO1xyXG5cclxuICBmdW5jdGlvbiBnZXRMYXN0SWQoZGF0YSkge1xyXG4gICAgbGV0IGlkID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwLCBuID0gZGF0YS5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgaWQgPSAoZGF0YVtpXS5pZCA+IGlkKSA/IGRhdGFbaV0uaWQgOiBpZDtcclxuICAgIH1cclxuICAgIHJldHVybiBpZDtcclxuICB9XHJcblxyXG4gIGZvciAobGV0IGkgPSAwLCBuID0gZGF0YS5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgIGNvbGxlY3Rpb24ucHVzaChuZXcgSW1hZ2VQb3N0KGRhdGFbaV0pKTtcclxuICB9XHJcblxyXG4gIHRoaXMuZ2V0SW1hZ2VQb3N0ID0gKGlkKSA9PiB7XHJcbiAgICBmb3IgKGxldCBpID0gMCwgbiA9IGNvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgIGlmIChjb2xsZWN0aW9uW2ldLmlkID09PSBpZCkgcmV0dXJuIGNvbGxlY3Rpb25baV07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ05vIGltYWdlIHBvc3Qgd2l0aCBpZDonLCBpZCk7XHJcbiAgfTtcclxuXHJcbiAgdGhpcy5hZGRJbWFnZVBvc3QgPSAoaW1nSW5mb09iaikgPT4ge1xyXG4gICAgaWYgKCFpbWdJbmZvT2JqLmlkKSBpbWdJbmZvT2JqLmlkID0gKytsYXN0SWQ7XHJcbiAgICBsZXQgaW1hZ2VQb3N0ID0gbmV3IEltYWdlUG9zdChpbWdJbmZvT2JqKTtcclxuICAgIGNvbGxlY3Rpb24ucHVzaChpbWFnZVBvc3QpO1xyXG4gIH07XHJcbn1cclxuXHJcbkltYWdlQ29sbGVjdGlvbi5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbihpZCwgaXNMaWtlLCBpc1BsdXMsIHRhcmdldCkge1xyXG4gIGxldCBpbWdQb3N0ID0gdGhpcy5nZXRJbWFnZVBvc3QoaWQpO1xyXG4gIGxldCBpbWdTbWFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpO1xyXG4gIGxldCBldmFsdWF0aW9uID0gaXNMaWtlID8gJ2xpa2UnIDogJ2Rpc2xpa2UnO1xyXG4gIGxldCBpY29uU21hbGwgPSBpbWdTbWFsbC5uZXh0RWxlbWVudFNpYmxpbmcucXVlcnlTZWxlY3RvcignLnNwcml0ZS0nICsgZXZhbHVhdGlvbik7XHJcbiAgbGV0IGN1cnJlbnRWYWx1ZTtcclxuXHJcbiAgLy8gcmVtZW1iZXIgbXkgZXZhbHVhdGlvblxyXG4gIGltZ1Bvc3QubXlFdmFsdWF0aW9uID0gZXZhbHVhdGlvbjtcclxuXHJcbiAgLy8gcmVzdWx0cyBpbiAnbGlrZXMnIHx8ICdkaXNsaWtlcydcclxuICBpZiAoaXNQbHVzKSBjdXJyZW50VmFsdWUgPSArK2ltZ1Bvc3RbZXZhbHVhdGlvbiArICdzJ107XHJcbiAgZWxzZSBjdXJyZW50VmFsdWUgPSAtLWltZ1Bvc3RbZXZhbHVhdGlvbiArICdzJ107XHJcblxyXG4gIGljb25TbWFsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY291bnQnLCBjdXJyZW50VmFsdWUpO1xyXG4gIHRhcmdldC5maXJzdEVsZW1lbnRDaGlsZC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY291bnQnLCBjdXJyZW50VmFsdWUpO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkcyBjb21tZW50IHRvIHRoZSBwb3N0IHdpdGggc2V0IGlkXHJcbiAqIEBwYXJhbSB7TnVtYmVyfVxyXG4gKiBAcGFyYW0ge09iamVjdH0gb2YgdHlwZSB7dGV4dCwgbmlja25hbWUsIGRhdGV9XHJcbiAqIEByZXR1cm5zXHJcbiAqL1xyXG5JbWFnZUNvbGxlY3Rpb24ucHJvdG90eXBlLmFkZENvbW1lbnQgPSBmdW5jdGlvbihpZCwgY29tbWVudCkge1xyXG4gIGxldCBwb3N0ID0gdGhpcy5nZXRJbWFnZVBvc3QoaWQpO1xyXG4gIHBvc3QuY29tbWVudHMudW5zaGlmdChuZXcgQ29tbWVudChcclxuICAgIGNvbW1lbnQudGV4dCxcclxuICAgIGNvbW1lbnQubmlja25hbWUsXHJcbiAgICBjb21tZW50LmRhdGVcclxuICApKTtcclxuICBwb3N0LnNob3dDb21tZW50cyhpZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEltYWdlUG9zdChkYXRhKSB7XHJcbiAgdGhpcy5pZCA9IGRhdGEuaWQgfHwgbnVsbDtcclxuICB0aGlzLmltZ1NtYWxsID0gZGF0YS5pbWdTbWFsbCB8fCBkYXRhLmltZ0JpZztcclxuICB0aGlzLmltZ0JpZyA9IGRhdGEuaW1nQmlnO1xyXG4gIHRoaXMub3JpZW50YXRpb24gPSBkYXRhLm9yaWVudGF0aW9uIHx8ICdub3JtYWwnO1xyXG4gIHRoaXMubGlrZXMgPSBkYXRhLmxpa2VzIHx8IDA7XHJcbiAgdGhpcy5kaXNsaWtlcyA9IGRhdGEuZGlzbGlrZXMgfHwgMDtcclxuICB0aGlzLmNvbW1lbnRzID0gW107XHJcbiAgdGhpcy5teUV2YWx1YXRpb24gPSBudWxsIC8vIG15IFwibGlrZVwiIHx8IFwiZGlzbGlrZVwiXHJcblxyXG4gIC8vc29ydCBjb21tZW50cyBkdWUgdG8gZGF0ZVxyXG4gIGRhdGEuY29tbWVudHMgJiYgZGF0YS5jb21tZW50cy5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICByZXR1cm4gYi5kYXRlIC0gYS5kYXRlO1xyXG4gIH0pO1xyXG5cclxuICBkYXRhLmNvbW1lbnRzICYmIGRhdGEuY29tbWVudHMuZm9yRWFjaCgoY29tbWVudCkgPT4ge1xyXG4gICAgdGhpcy5jb21tZW50cy5wdXNoKG5ldyBDb21tZW50KFxyXG4gICAgICBjb21tZW50LnRleHQsXHJcbiAgICAgIGNvbW1lbnQubmlja25hbWUsXHJcbiAgICAgIGNvbW1lbnQuZGF0ZVxyXG4gICAgKSk7XHJcbiAgfSk7XHJcblxyXG4gIHRoaXMubm9kZSA9IHB1dEluR3JpZCh0aGlzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHV0SW5HcmlkKHNlbGYpIHtcclxuICBsZXQgZ3JpZEl0ZW0sIGltZywgaG92ZXJCb3gsIGljb247XHJcblxyXG4gIGZ1bmN0aW9uIGFkZEljb24oY2xhc3NOYW1lLCBkYXRhQ291bnQpIHtcclxuICAgIGxldCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnSScpO1xyXG4gICAgaWNvbi5jbGFzc05hbWUgPSAnc3ByaXRlICcgKyBjbGFzc05hbWU7XHJcbiAgICBpY29uLnNldEF0dHJpYnV0ZSgnZGF0YS1jb3VudCcsIGRhdGFDb3VudCk7XHJcbiAgICByZXR1cm4gaWNvbjtcclxuICB9XHJcblxyXG4gIGdyaWRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcblxyXG4gIHN3aXRjaChzZWxmLm9yaWVudGF0aW9uKSB7XHJcbiAgICBjYXNlICdsYW5kc2NhcGUnOlxyXG4gICAgZ3JpZEl0ZW0uY2xhc3NOYW1lID0gJ2dyaWQtaXRlbSBncmlkLWl0ZW0tLXdpZHRoJztcclxuICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgJ3BvcnRyYWl0JzpcclxuICAgIGdyaWRJdGVtLmNsYXNzTmFtZSA9ICdncmlkLWl0ZW0gZ3JpZC1pdGVtLS1oZWlnaHQnO1xyXG4gICAgYnJlYWs7XHJcblxyXG4gICAgZGVmYXVsdDpcclxuICAgIGdyaWRJdGVtLmNsYXNzTmFtZSA9ICdncmlkLWl0ZW0nO1xyXG4gIH1cclxuXHJcbiAgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnSU1HJyk7XHJcbiAgaW1nLnNyYyA9IHNlbGYuaW1nU21hbGw7XHJcbiAgaW1nLmFsdCA9ICdJbWFnZSAnICsgc2VsZi5pZDtcclxuICBpbWcuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgc2VsZi5pZCk7XHJcbiAgZ3JpZEl0ZW0uYXBwZW5kQ2hpbGQoaW1nKTtcclxuXHJcbiAgaG92ZXJCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICBob3ZlckJveC5jbGFzc05hbWUgPSAnaG92ZXItYm94JztcclxuXHJcbiAgaG92ZXJCb3guYXBwZW5kQ2hpbGQoYWRkSWNvbignc3ByaXRlLWNvbW1lbnQnLCBzZWxmLmNvbW1lbnRzLmxlbmd0aCkpO1xyXG4gIGhvdmVyQm94LmFwcGVuZENoaWxkKGFkZEljb24oJ3Nwcml0ZS1saWtlJywgc2VsZi5saWtlcykpO1xyXG4gIGhvdmVyQm94LmFwcGVuZENoaWxkKGFkZEljb24oJ3Nwcml0ZS1kaXNsaWtlJywgc2VsZi5kaXNsaWtlcykpO1xyXG5cclxuICBncmlkSXRlbS5hcHBlbmRDaGlsZChob3ZlckJveCk7XHJcblxyXG4gIC8vIGluc2VydCBiZWZvcmUgcGxhY2Vob2xkZXIgZm9yIGFkZGluZyBpbWFnZXNcclxuICBncmlkLmluc2VydEJlZm9yZShncmlkSXRlbSwgZ3JpZC5sYXN0RWxlbWVudENoaWxkKTtcclxuXHJcbiAgLy9yZWRyYXcgUGFja2VyeVxyXG4gIHBja3J5LnJlbG9hZEl0ZW1zKClcclxuICBwY2tyeS5sYXlvdXQoKTtcclxuXHJcbiAgLy9hZGp1c3Qgc2Nyb2xsYmFyXHJcbiAgc2Nyb2xsWC5hZGp1c3RTaXplKCk7XHJcblxyXG4gIHJldHVybiBncmlkSXRlbTtcclxufVxyXG5cclxuXHJcbkltYWdlUG9zdC5wcm90b3R5cGUuc2hvd0NvbW1lbnRzID0gKGZ1bmN0aW9uKCkge1xyXG4gIGxldCBjb21tZW50c0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50cycpXHJcbiAgcmV0dXJuIGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAvLyBjbGVhciBkaXZcclxuICAgIGNvbW1lbnRzRGl2LmlubmVySFRNTCA9ICcnO1xyXG4gICAgdGhpcy5jb21tZW50cy5mb3JFYWNoKChjb21tZW50KSA9PiB7XHJcbiAgICAgIGNvbW1lbnQucHV0T25QYWdlKGNvbW1lbnRzRGl2KTtcclxuICAgIH0pO1xyXG4gICAgLy8gdXBkYXRlIGljb25zIGFuZCBjb21tZW50cyBudW1iZXJcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1jb21tZW50cyBoMiBzcGFuJylcclxuICAgIC50ZXh0Q29udGVudCA9IHRoaXMuY29tbWVudHMubGVuZ3RoO1xyXG5cclxuICAgIGlmIChpZCkge1xyXG4gICAgICB0aGlzLm5vZGUucXVlcnlTZWxlY3RvcignLnNwcml0ZS1jb21tZW50JylcclxuICAgICAgLnNldEF0dHJpYnV0ZSgnZGF0YS1jb3VudCcsIHRoaXMuY29tbWVudHMubGVuZ3RoKTtcclxuICAgIH1cclxuICB9O1xyXG59KSgpO1xyXG5cclxuZnVuY3Rpb24gQ29tbWVudCh0ZXh0LCBuaWNrbmFtZSwgZGF0ZSkge1xyXG4gIHRoaXMudGV4dCA9IHRleHQ7XHJcbiAgdGhpcy5uaWNrbmFtZSA9IG5pY2tuYW1lO1xyXG4gIHRoaXMuZGF0ZSA9IHBhcnNlRGF0ZShuZXcgRGF0ZShkYXRlKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBhcnNlRGF0ZShkYXRlKSB7XHJcbiAgbGV0IG1pbnV0ZXMgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICBtaW51dGVzID0gKG1pbnV0ZXMgPCAxMCkgPyAnMCcgKyBtaW51dGVzIDogbWludXRlcztcclxuICBsZXQgaG91cnMgPSBkYXRlLmdldEhvdXJzKCk7XHJcbiAgbGV0IGRheVBhcnQgPSAoaG91cnMgPiAxMikgPyAnUE0nIDogJ0FNJztcclxuICBob3VycyA9IChob3VycyA+IDEyKSA/IGhvdXJzIC0gMTIgOiBob3VycztcclxuXHJcbiAgbGV0IG9uZURheSA9IDI0KjYwKjYwKjEwMDA7XHJcbiAgbGV0IGRpZmYsIGRpZmZEYXlzLCBkaWZmTW9udGgsIGRpZmZZZWFyLCBub3cgPSBuZXcgRGF0ZSgpO1xyXG5cclxuICBkaWZmRGF5cyA9IE1hdGgucm91bmQoKG5vdyAtIGRhdGUpIC8gb25lRGF5KTtcclxuICBkaWZmWWVhciA9IG5vdy5nZXRGdWxsWWVhcigpIC0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG5cclxuICBpZiAoZGlmZkRheXMgPiAzNjUpIHtcclxuICAgIGxldCB5ZWFyID0gKGRpZmZZZWFyID09IDEpID8gJyB5ZWFyJyA6ICcgeWVhcnMnO1xyXG4gICAgZGlmZiA9IGRpZmZZZWFyICsgeWVhciArICcgYWdvJztcclxuICB9IGVsc2UgaWYgKGRpZmZEYXlzID4gMzEpIHtcclxuICAgIGRpZmZNb250aCA9IG5vdy5nZXRNb250aCgpIC0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgaWYgKGRpZmZZZWFyKSBkaWZmTW9udGggKz0gMTI7XHJcbiAgICBsZXQgbW9udGggPSAoZGlmZk1vbnRoID09IDEpID8gJyBtb250aCcgOiAnIG1vbnRocyc7XHJcbiAgICBkaWZmID0gZGlmZk1vbnRoICsgbW9udGggKyAnIGFnbyc7XHJcbiAgfSBlbHNlIGlmIChkaWZmRGF5cyA+IDEpIHtcclxuICAgIGRpZmYgPSBkaWZmRGF5cyArICcgZGF5cyBhZ28nO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkRheXMgPT0gMSkge1xyXG4gICAgZGlmZiA9ICdZZXN0ZXJkYXknO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBkaWZmID0gJ1RvZGF5JztcclxuICB9XHJcblxyXG4gIHJldHVybiBkaWZmICsgJyAnICsgaG91cnMgKyAnOicgKyBtaW51dGVzICsgJyAnICsgZGF5UGFydDtcclxufVxyXG5cclxuQ29tbWVudC5wcm90b3R5cGUucHV0T25QYWdlID0gZnVuY3Rpb24ocGFyZW50Tm9kZSkge1xyXG4gIGZ1bmN0aW9uIGNyZWF0ZVNwYW4oY2xhc3NOYW1lLCB0ZXh0Q29udGVudCkge1xyXG4gICAgbGV0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdTUEFOJyk7XHJcbiAgICBzcGFuLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcclxuICAgIHNwYW4udGV4dENvbnRlbnQgPSB0ZXh0Q29udGVudDtcclxuICAgIHJldHVybiBzcGFuO1xyXG4gIH1cclxuXHJcbiAgbGV0IGNvbW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICBjb21tZW50LmNsYXNzTmFtZSA9ICdjb21tZW50JztcclxuXHJcbiAgY29tbWVudC5hcHBlbmRDaGlsZChjcmVhdGVTcGFuKCduaWNrbmFtZScsIHRoaXMubmlja25hbWUpKTtcclxuICBjb21tZW50LmFwcGVuZENoaWxkKGNyZWF0ZVNwYW4oJ2RhdGUnLCB0aGlzLmRhdGUpKTtcclxuXHJcbiAgbGV0IHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICB0ZXh0LmNsYXNzTmFtZSA9ICdjb21tZW50LXRleHQnO1xyXG4gIHRleHQuYXBwZW5kQ2hpbGQoY3JlYXRlU3BhbignJywgdGhpcy50ZXh0KSk7XHJcbiAgY29tbWVudC5hcHBlbmRDaGlsZCh0ZXh0KTtcclxuXHJcbiAgcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChjb21tZW50KTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSW1hZ2VDb2xsZWN0aW9uO1xyXG5cclxufSgpKTtcclxuXG59LHtcIi4vc2Nyb2xsYmFyLmVzNi5qc1wiOjN9XSwzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbi8vVE9ETzogYWRkIHdoZWVsIGV2ZW50c1xyXG4oKCkgPT4ge1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG4vKipcclxuICogQ29uc3RydWN0b3IgZnVuY3Rpb24gZm9yIHNjcm9sbGJhcnNcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gc2Nyb2xsQmFyXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSAnaCcgZm9yIGhvcml6b250YWwgfHwgJ3YnIGZvciB2ZXJ0aWNhbFxyXG4gKiBAcmV0dXJucyB7T2JqZWN0fSB3aXRoIG1ldGhvZHMgZm9yIGhhbmRsaW5nIHNjcm9sbGJhclxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gU2Nyb2xsYmFyKHNjcm9sbEJhciwgZGlyZWN0aW9uKSB7XHJcbiAgbGV0IHNjcm9sbEJveCA9IHNjcm9sbEJhci5wYXJlbnROb2RlO1xyXG4gIGxldCBzY3JvbGxlZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yXHJcbiAgICAgICAgICAgICAgICAgICAoc2Nyb2xsQm94LmdldEF0dHJpYnV0ZSgnZGF0YS1zY3JvbGxlZC1hcmVhJykpO1xyXG4gIGxldCBzY3JvbGxlZEJveCA9IHNjcm9sbGVkQXJlYS5wYXJlbnROb2RlO1xyXG5cclxuICAvLyBpZiBncmlkIGlzIHdpZGVyIHJldHVybnMgdGhlIGRpZmZlcmVuY2UgaW4gcGVyY2VudHNcclxuICAvLyBvdGhlcndpc2UgcmV0dXJucyAxMDAlXHJcbiAgbGV0IGdldEFyZWFUb0JveFJhdGlvID0gKCkgPT4ge1xyXG4gICAgbGV0IGFyZWFXaWR0aCA9IHNjcm9sbGVkQXJlYS5jbGllbnRXaWR0aDtcclxuICAgIGxldCBib3hXaWR0aCA9IHNjcm9sbGVkQm94LmNsaWVudFdpZHRoO1xyXG5cclxuICAgIGlmIChhcmVhV2lkdGggPiBib3hXaWR0aCkge1xyXG4gICAgICByZXR1cm4gKGJveFdpZHRoIC8gYXJlYVdpZHRoICogMTAwKSArICclJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiAxMDAgKyAnJSc7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gRW5hYmxlIHNjcm9sbCBpZiBhcmVhIGlzIHdpZGVyXHJcbiAgLy8gc2V0cyBzaXplIG9mIHNjcm9sbC1iYXJcclxuICB0aGlzLmFkanVzdFNpemUgPSAoKSA9PiB7XHJcbiAgICBsZXQgcmF0aW8gPSBnZXRBcmVhVG9Cb3hSYXRpbygpO1xyXG5cclxuICAgIGlmIChyYXRpbyA9PSAnMTAwJScpXHJcbiAgICAgIHNjcm9sbEJveC5zdHlsZS5vcGFjaXR5ID0gMDtcclxuICAgIGVsc2Uge1xyXG4gICAgICBzY3JvbGxCb3guc3R5bGUub3BhY2l0eSA9IDE7XHJcbiAgICAgIHNjcm9sbEJhci5zdHlsZS53aWR0aCA9IHJhdGlvO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIGV2ZW50IGhhbmRsZXIgZm9yIHNjcm9sbGJhcnNcclxuXHJcbiAgLy8gdXNlIGNsb3N1cmUgdG8ga2VlcCB0cmFjayBvZiBtb3VzZSBtb3ZlXHJcbiAgLy8gYW5kIGF0dGFjaCBldmVudCBoYW5kbGVyIHRvIHdpbmRvdyBvbmx5IG9uY2VcclxuICBsZXQgb25Nb3ZlID0gKCgpID0+IHtcclxuICAgIC8vWCBmb3Igc2Nyb2xsQmFyWCBhbmQgWSBmb3Igc2Nyb2xsQmFyWVxyXG4gICAgbGV0IGxhc3RNb3VzZVggPSBudWxsLFxyXG4gICAgICAgIGxhc3RNb3VzZVkgPSBudWxsLFxyXG4gICAgICAgIG1hcmdpbiA9IHBhcnNlRmxvYXQod2luZG93LlxyXG4gICAgICAgICAgICAgICAgICBnZXRDb21wdXRlZFN0eWxlKHNjcm9sbEJhcikubWFyZ2luTGVmdCksXHJcbiAgICAgICAgc2Nyb2xsQm94V2lkdGggPSBzY3JvbGxCYXIucGFyZW50Tm9kZS5jbGllbnRXaWR0aDtcclxuXHJcbiAgICAvL29uTW92ZSBIYW5kbGVyXHJcbiAgICBsZXQgb25Nb3ZlID0gKGUpID0+IHtcclxuICAgICAgbGV0IGRpZmYsXHJcbiAgICAgICAgICBzY3JvbGxCYXIgPSBvbk1vdmUuY3VycmVudFRhcmdldCxcclxuICAgICAgICAgIHNjcm9sbEJhclNpemUgPSBvbk1vdmUuc2Nyb2xsQmFyU2l6ZSxcclxuICAgICAgICAgIHNjcm9sbEFyZWFTaXplID0gb25Nb3ZlLnNjcm9sbEFyZWFTaXplO1xyXG5cclxuICAgICAgLy9yZW1lbWJlciBpbml0aWFsIHBvc2l0aW9uIG9mIHRoZSBtb3VzZVxyXG4gICAgICBpZiAobGFzdE1vdXNlWCA9PT0gbnVsbCkge1xyXG4gICAgICAgIGxhc3RNb3VzZVggPSBlLmNsaWVudFg7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGdldCBtb3VzZSBtb3ZlXHJcbiAgICAgIGRpZmYgPSBlLmNsaWVudFggLSBsYXN0TW91c2VYO1xyXG4gICAgICBsYXN0TW91c2VYID0gZS5jbGllbnRYO1xyXG5cclxuICAgICAgbWFyZ2luICs9IGRpZmY7XHJcbiAgICAgIC8vcHJldmVudCBkcmFnZ2luZyB0byBsZWZ0IGlmIG9uIGVkZ2VcclxuICAgICAgaWYgKG1hcmdpbiA8PSAwKSB7XHJcbiAgICAgICAgc2Nyb2xsQmFyLnN0eWxlLm1hcmdpbkxlZnQgPSBtYXJnaW4gPSAwO1xyXG4gICAgICAgIC8vIHRvIHByZXZlbnQgaW5zdWZmaWNpZW50IHNjcm9sbCwgd2hlbiBicm93c2VyIHJlbmRlcnMgc2Nyb2xsIHRvIHNsb3dcclxuICAgICAgICBzY3JvbGxlZEJveC5zY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIC8vcHJldmVudCBkcmFnZ2luZyB0byByaWdodCBpZiBvbiBlZGdlXHJcbiAgICB9IGVsc2UgaWYgKHNjcm9sbEJhclNpemUgKyBtYXJnaW4gPj0gc2Nyb2xsQm94V2lkdGgpIHtcclxuICAgICAgICBtYXJnaW4gPSBzY3JvbGxCb3hXaWR0aCAtIHNjcm9sbEJhclNpemU7XHJcbiAgICAgIH1cclxuICAgICAgc2Nyb2xsQmFyLnN0eWxlLm1hcmdpbkxlZnQgPSBtYXJnaW4gKyAncHgnO1xyXG5cclxuICAgICAgLy9hZGp1c3QgZ3JpZCBwb3NpdGlvbiBkdWUgdG8gcGVyY2VudGFnZSB2YWx1ZSBvZiBzY3JvbGwtYmFyIG1hcmdpblxyXG4gICAgICAvLyoqKi0+LT4tPiBzY3JvbGxiYXIubWFyZ2luTGVmdCAvIHBhcmVudC53aWR0aCA9IC1ncmlkLm1hcmdpbkxlZnQgLyBncmlkLndpZHRoIDwtPC08LSoqKlxyXG4gICAgICBzY3JvbGxlZEJveC5zY3JvbGxMZWZ0ID0gbWFyZ2luIC8gc2Nyb2xsQm94V2lkdGggKiBzY3JvbGxBcmVhU2l6ZTtcclxuICAgIH07XHJcblxyXG4gICAgLy90byBkaXNhYmxlIHNjcm9sbGluZyBvbm1vdXNldXBcclxuICAgIGxldCByZW1vdmVTY3JvbGxMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdmUpO1xyXG4gICAgICBsYXN0TW91c2VYID0gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCByZW1vdmVTY3JvbGxMaXN0ZW5lcnMpO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCByZW1vdmVTY3JvbGxMaXN0ZW5lcnMpO1xyXG5cclxuICAgIHJldHVybiBvbk1vdmU7XHJcbiAgfSkoKTtcclxuXHJcbiAgc2Nyb2xsQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7XHJcbiAgICAvL3JlbWVtYmVyIHdoaWNoIHNjcm9sbGJhciB3ZSBhcmUgY3VycmVudGx5IG9uXHJcbiAgICBvbk1vdmUuY3VycmVudFRhcmdldCA9IGUudGFyZ2V0O1xyXG5cclxuICAgIC8vcmVtZW1iZXIgc2l6ZSBvZiB0aGUgc2Nyb2xsYmFyIGFuZCB3aWR0aCBvZiB0aGUgc2Nyb2xsQXJlYVxyXG4gICAgLy90aGV5IGFyZSBuZWVkZWQgZm9yIGRyYWdnaW5nIGNvbXB1dGF0aW9uc1xyXG4gICAgaWYgKGRpcmVjdGlvbiA9PSAnaCcpIHtcclxuICAgICAgb25Nb3ZlLnNjcm9sbEJhclNpemUgPSBlLnRhcmdldC5jbGllbnRXaWR0aDtcclxuICAgICAgb25Nb3ZlLnNjcm9sbEFyZWFTaXplID0gc2Nyb2xsZWRBcmVhLmNsaWVudFdpZHRoO1xyXG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gJ3YnKSB7XHJcbiAgICAgIG9uTW92ZS5zY3JvbGxCYXJTaXplID0gZS50YXJnZXQuY2xpZW50SGVpZ2h0O1xyXG4gICAgICBvbk1vdmUuc2Nyb2xsQXJlYVNpemUgPSBzY3JvbGxlZEFyZWEuY2xpZW50SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdmUpO1xyXG4gIH0pO1xyXG5cclxufTtcclxuXHJcbn0pKCk7XHJcblxufSx7fV19LHt9LFsxXSkiXX0=
